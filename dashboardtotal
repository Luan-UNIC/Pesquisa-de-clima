<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Pesquisa de Clima Organizacional</title>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 40px;
            background: #f8f9fa;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
        }

        .metric-value {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }

        .metric-label {
            font-size: 1.1em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .section {
            padding: 40px;
        }

        .section-title {
            font-size: 2em;
            color: #333;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .alert-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .alert-box.critical {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .alert-box h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .alert-box.critical h3 {
            color: #721c24;
        }

        .dept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .dept-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .dept-card.critical {
            border: 3px solid #dc3545;
        }

        .dept-card.warning {
            border: 3px solid #ffc107;
        }

        .dept-card.good {
            border: 3px solid #28a745;
        }

        .dept-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .dept-score {
            font-size: 2.5em;
            font-weight: bold;
            margin: 15px 0;
        }

        .dept-card.critical .dept-score {
            color: #dc3545;
        }

        .dept-card.warning .dept-score {
            color: #ffc107;
        }

        .dept-card.good .dept-score {
            color: #28a745;
        }

        .footer {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Dashboard - Pesquisa de Clima Organizacional</h1>
            <p>An√°lise Completa | 1.248 Respostas | 9 Departamentos</p>
        </div>

        <div class="metrics">
            <div class="metric-card">
                <div class="metric-label">M√©dia Geral</div>
                <div class="metric-value">4.52</div>
                <div class="metric-label">/ 5.00</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Respostas Favor√°veis</div>
                <div class="metric-value">86.1%</div>
                <div class="metric-label">Notas 4-5</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Respostas Cr√≠ticas</div>
                <div class="metric-value">4.6%</div>
                <div class="metric-label">Notas 1-2</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Total Respostas</div>
                <div class="metric-value">1.248</div>
                <div class="metric-label">Participantes</div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">üè¢ Ranking de Departamentos</h2>
            <div class="chart-container">
                <div id="deptChart"></div>
            </div>
        </div>

        <div class="section" style="background: #f8f9fa;">
            <h2 class="section-title">üìã Departamentos - Vis√£o Detalhada</h2>
            <div class="dept-grid">

                <div class="dept-card good">
                    <div class="dept-name">üü¢ Marketing</div>
                    <div class="dept-score">5.00</div>
                    <p><strong>Gap vs Empresa:</strong> +0.48</p>
                    <p><strong>N Respostas:</strong> 78</p>
                </div>

                <div class="dept-card good">
                    <div class="dept-name">üü¢ Financeiro</div>
                    <div class="dept-score">4.90</div>
                    <p><strong>Gap vs Empresa:</strong> +0.38</p>
                    <p><strong>N Respostas:</strong> 156</p>
                </div>

                <div class="dept-card good">
                    <div class="dept-name">üü¢ Gente e Cultura</div>
                    <div class="dept-score">4.86</div>
                    <p><strong>Gap vs Empresa:</strong> +0.34</p>
                    <p><strong>N Respostas:</strong> 156</p>
                </div>

                <div class="dept-card good">
                    <div class="dept-name">üü¢ Facilities</div>
                    <div class="dept-score">4.81</div>
                    <p><strong>Gap vs Empresa:</strong> +0.29</p>
                    <p><strong>N Respostas:</strong> 78</p>
                </div>

                <div class="dept-card good">
                    <div class="dept-name">üü¢ Cobran√ßa</div>
                    <div class="dept-score">4.79</div>
                    <p><strong>Gap vs Empresa:</strong> +0.27</p>
                    <p><strong>N Respostas:</strong> 156</p>
                </div>

                <div class="dept-card warning">
                    <div class="dept-name">üü† Opera√ß√µes</div>
                    <div class="dept-score">4.40</div>
                    <p><strong>Gap vs Empresa:</strong> -0.12</p>
                    <p><strong>N Respostas:</strong> 156</p>
                </div>

                <div class="dept-card warning">
                    <div class="dept-name">üü† T.I</div>
                    <div class="dept-score">4.37</div>
                    <p><strong>Gap vs Empresa:</strong> -0.15</p>
                    <p><strong>N Respostas:</strong> 78</p>
                </div>

                <div class="dept-card critical">
                    <div class="dept-name">üî¥ Cr√©dito e Cadastro</div>
                    <div class="dept-score">4.10</div>
                    <p><strong>Gap vs Empresa:</strong> -0.42</p>
                    <p><strong>N Respostas:</strong> 312</p>
                </div>

                <div class="dept-card critical">
                    <div class="dept-name">üî¥ Controladoria</div>
                    <div class="dept-score">3.88</div>
                    <p><strong>Gap vs Empresa:</strong> -0.64</p>
                    <p><strong>N Respostas:</strong> 78</p>
                </div>

            </div>
        </div>

        <div class="section">
            <h2 class="section-title">üìä An√°lise por Dimens√£o</h2>
            <div class="chart-container">
                <div id="dimChart"></div>
            </div>
        </div>

        <div class="section" style="background: #f8f9fa;">
            <h2 class="section-title">üî• Mapa de Calor: Departamento x Dimens√£o</h2>
            <div class="chart-container">
                <div id="heatmapChart"></div>
            </div>
        </div>

        <div class="section">
            <div class="alert-box critical">
                <h3>üö® ALERTA CR√çTICO: Departamentos Problem√°ticos</h3>
                <p><strong>Controladoria:</strong> M√©dia 3.88 (Gap: -0.64) - PIOR departamento</p>
                <p><strong>Cr√©dito e Cadastro:</strong> M√©dia 4.10 (Gap: -0.42) - Maior departamento com problemas</p>
                <p><strong>A√ß√£o Imediata:</strong> Interven√ß√£o em 48-72h necess√°ria</p>
            </div>

            <div class="alert-box">
                <h3>‚ö†Ô∏è ATEN√á√ÉO: Mesmo L√≠der</h3>
                <p><strong>Opera√ß√µes:</strong> M√©dia 4.40 | <strong>Controladoria:</strong> M√©dia 3.88</p>
                <p><strong>Diferen√ßa:</strong> 0.52 pontos entre departamentos do mesmo l√≠der</p>
                <p><strong>Problema comum:</strong> Reconhecimento & Feedback cr√≠tico em ambos</p>
            </div>
        </div>

        <div class="section" style="background: #f8f9fa;">
            <h2 class="section-title">üìà Distribui√ß√£o de Respostas</h2>
            <div class="chart-container">
                <div id="distChart"></div>
            </div>
        </div>

        <div class="footer">
            <p><strong>Pesquisa de clima UNIC</strong> | An√°lise de People Analytics</p>
            <p>Relat√≥rio Confidencial - Uso exclusivo da lideran√ßa e RH</p>
        </div>
    </div>

    <script>
        // Dados dos departamentos
        const deptData = {"Marketing": {"mean": 5.0, "gap": 0.48}, "Financeiro": {"mean": 4.9, "gap": 0.38}, "Gente e Cultura": {"mean": 4.86, "gap": 0.34}, "Facilities": {"mean": 4.81, "gap": 0.29}, "Cobran√ßa": {"mean": 4.79, "gap": 0.27}, "Opera√ß√µes": {"mean": 4.4, "gap": -0.12}, "T.I": {"mean": 4.37, "gap": -0.15}, "Cr√©dito e Cadastro": {"mean": 4.1, "gap": -0.42}, "Controladoria": {"mean": 3.88, "gap": -0.64}};

        // Gr√°fico de Departamentos
        const deptNames = Object.keys(deptData);
        const deptMeans = deptNames.map(d => deptData[d].mean);
        const deptGaps = deptNames.map(d => deptData[d].gap);
        const deptColors = deptGaps.map(g => g < -0.3 ? '#dc3545' : g < 0 ? '#ffc107' : '#28a745');

        const deptTrace = {
            x: deptNames,
            y: deptMeans,
            type: 'bar',
            marker: {
                color: deptColors,
                line: {
                    color: '#333',
                    width: 1
                }
            },
            text: deptMeans.map(m => m.toFixed(2)),
            textposition: 'outside'
        };

        const deptLayout = {
            title: 'M√©dia por Departamento (Benchmark: 4.52)',
            xaxis: { title: 'Departamento' },
            yaxis: { title: 'M√©dia', range: [0, 5.5] },
            shapes: [{
                type: 'line',
                x0: -0.5,
                x1: deptNames.length - 0.5,
                y0: 4.52,
                y1: 4.52,
                line: {
                    color: '#667eea',
                    width: 3,
                    dash: 'dash'
                }
            }],
            height: 500
        };

        Plotly.newPlot('deptChart', [deptTrace], deptLayout);

        // Gr√°fico de Dimens√µes
        const dimData = {"Conex√£o com l√≠der": 4.72, "Embaixador": 4.64, "Crescimento pessoal": 4.56, "Bem-estar": 4.55, "Satisfa√ß√£o": 4.55, "Cultura": 4.54, "Conex√£o com colegas": 4.51, "Empoderamento": 4.44, "Reconhecimento & Feedback": 4.21};
        const dimNames = Object.keys(dimData);
        const dimMeans = Object.values(dimData);

        const dimTrace = {
            x: dimNames,
            y: dimMeans,
            type: 'bar',
            marker: {
                color: '#764ba2',
                line: {
                    color: '#333',
                    width: 1
                }
            },
            text: dimMeans.map(m => m.toFixed(2)),
            textposition: 'outside'
        };

        const dimLayout = {
            title: 'M√©dia por Dimens√£o',
            xaxis: { title: 'Dimens√£o', tickangle: -45 },
            yaxis: { title: 'M√©dia', range: [0, 5.5] },
            height: 500,
            margin: { b: 150 }
        };

        Plotly.newPlot('dimChart', [dimTrace], dimLayout);

        // Heatmap
        const heatmapData = {"columns":["Bem-estar","Conex\u00e3o com colegas","Conex\u00e3o com l\u00edder","Crescimento pessoal","Cultura","Embaixador","Empoderamento","Reconhecimento & Feedback","Satisfa\u00e7\u00e3o"],"index":["Cobran\u00e7a","Controladoria","Cr\u00e9dito e Cadastro","Facilities","Financeiro","Gente e Cultura","Marketing","Opera\u00e7\u00f5es","T.I"],"data":[[4.9,5.0,4.95,4.9,4.5,5.0,4.61,4.44,4.75],[3.8,4.56,3.8,3.93,4.0,3.86,3.93,2.88,4.25],[4.2,3.72,4.5,4.13,4.12,4.04,4.07,4.0,4.0],[4.4,5.0,5.0,4.8,5.0,4.71,4.79,4.5,5.0],[5.0,4.94,5.0,4.97,5.0,5.0,4.61,4.94,4.75],[5.0,4.78,5.0,4.87,5.0,4.86,4.79,4.62,5.0],[5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0],[4.5,4.44,4.6,4.33,4.42,4.93,4.57,3.38,4.38],[4.0,4.33,4.6,4.53,4.33,5.0,3.86,4.25,4.75]]};
        const heatmapParsed = JSON.parse(heatmapData);

        const heatmapTrace = {
            z: heatmapParsed.data,
            x: heatmapParsed.columns,
            y: heatmapParsed.index,
            type: 'heatmap',
            colorscale: [
                [0, '#dc3545'],
                [0.5, '#ffc107'],
                [1, '#28a745']
            ],
            text: heatmapParsed.data.map(row => row.map(v => v.toFixed(2))),
            texttemplate: '%{text}',
            textfont: { size: 10 },
            colorbar: {
                title: 'M√©dia'
            }
        };

        const heatmapLayout = {
            title: 'Mapa de Calor: Departamento x Dimens√£o',
            xaxis: { title: 'Dimens√£o', tickangle: -45 },
            yaxis: { title: 'Departamento' },
            height: 600,
            margin: { b: 150, l: 150 }
        };

        Plotly.newPlot('heatmapChart', [heatmapTrace], heatmapLayout);

        // Distribui√ß√£o de respostas
        const distData = {1: 15, 2: 43, 3: 115, 4: 179, 5: 896};
        const distLabels = Object.keys(distData);
        const distValues = Object.values(distData);

        const distTrace = {
            labels: distLabels.map(l => 'Nota ' + l),
            values: distValues,
            type: 'pie',
            marker: {
                colors: ['#dc3545', '#fd7e14', '#ffc107', '#28a745', '#20c997']
            },
            textinfo: 'label+percent',
            textposition: 'outside'
        };

        const distLayout = {
            title: 'Distribui√ß√£o de Respostas (Escala 1-5)',
            height: 500
        };

        Plotly.newPlot('distChart', [distTrace], distLayout);
    </script>
</body>
</html>
